<!doctype html>
<html lang="en" data-bs-theme="auto">
  <head>

    <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="KAJIAN PENGGUNAAN ENERGI KENDARAAN LISTRIK RODA DUA BERDASARKAN RUTE PERJALANAN SEPEDA MOTOR PADA PETA DIGITAL" />
        <meta name="author" content="Universitas Tanjungpura" />
        <title>KAJIAN PENGGUNAAN ENERGI KENDARAAN LISTRIK RODA DUA BERDASARKAN RUTE PERJALANAN SEPEDA MOTOR PADA PETA DIGITAL</title>
        <link rel="icon" type="image/x-icon" href="favicon.ico">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

        <!-- Admin LTE style -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/maptalks/dist/maptalks.css">

    
    <!-- Custom styles for this template -->
    <link href="navbar-fixed.css" rel="stylesheet">
  </head>
  <body>

        <nav class="navbar fixed-top sb-topnav navbar-light bg-light">
            &nbsp;&nbsp;&nbsp;&nbsp;<button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!"><i class="bi bi-menu-button-wide"></i></button>
            <p class="navbar-brand ps-3" href="#"><img src="logountan.png" width="40px" height="40px" style="opacity: .9;display: block;"></p>
            <form class="d-none d-md-inline-block form-inline ms-auto me-0 me-md-3 my-2 my-md-0">
            </form>
            <!-- Navbar-->
            <ul class="navbar-nav ms-auto ms-md-0 me-3 me-lg-4">
                <li class="nav-item dropdown">
                    <button type="button" class="btn btn-default" data-bs-toggle="modal" data-bs-target="#modal-welcome">
                      <i class="bi bi-info-circle-fill mr-2"></i>
                    </button>
                </li>
            </ul>
        </nav>

<main class="container-fluid">
  
    <!-- Main content -->
    <section class="content" id="toSee">

            <div class="row" id="thefrontshow">
              <div class="col-sm-12">
                <div class="card shadow-lg">
                  <div class="card-header">
                    <h5 class="card-title"><i class="bi bi-map-fill mr-1"></i>
                    Peta</h5>
                  </div>
                  <div class="card-body" id="mapshowplace">
                      <div class="btn-group btn-group-toggle">
                        <button type="button" class="btn btn-primary" onclick="cTileLayerShow('osm');">OSM</button>
                        <button type="button" class="btn btn-primary" onclick="cTileLayerShow('satelite');">Satelit</button>
                        </label>
                      </div>
                    <div id="mapshow" style="width: 100%;height: 500px;"></div>
                  </div>
                </div>
              </div>
              <div class="col-sm-12 mt-1">
                <div class="card shadow-lg">
                  <div class="card-header">
                    <h5 class="card-title"><i class="bi bi-pin-map-fill"></i>
                    Rute Perjalanan</h5>
                  </div>
                  <div class="card-body" style="overflow-y: scroll;height:540px;">
                    <div class="row">
                      <div class="col-md-6">
                        <h6 class="d-flex justify-content-between align-items-center mb-3">
                          <span class="text-primary">Titik Arah</span>
                          <span class="badge bg-primary rounded-pill" id="jmltitik">0</span>
                        </h6>
                        <div class="card p-2">
                          <div class="input-group">
                              <button class="btn btn-success" onclick="tambahTitikArah();"><i class="bi bi-plus-circle-fill"></i> Tambah Titik Arah</button>
                              <button class="btn btn-primary" onclick="geetjsonrute();">Tampilkan Rute</button>
                          </div>
                        </div>
                        <ul class="list-group mb-3" id="filterdialog">
                        </ul>

                      </div>
                      <div class="col-md-6">
                        <h6 class="d-flex justify-content-between align-items-center mb-3">
                          <span class="text-primary">Informasi Rute</span>
                          <span class="badge bg-primary rounded-pill"></span>
                        </h6>
                        <ul class="list-group mb-3" id="detaildialog">
                          <div class="card p-2">
                            Detail informasi Rute Akan tampil setelah menentukan 2 atau lebih titik arah dan klik Tampilkan Rute
                          </div>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

            </div>
    </section>
</main>
<div class="modal fade" id="modal-welcome">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<h4 class="modal-title" id="logintitle">Selamat Datang</h4>
<button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
<span aria-hidden="true">&times;</span>
</button>
</div>
<div class="modal-body">
  <div class="card">
    <div class="card-header text-center">
      <a href="#" class="h5"><b>KAJIAN PENGGUNAAN ENERGI KENDARAAN LISTRIK RODA DUA BERDASARKAN RUTE PERJALANAN SEPEDA MOTOR PADA PETA DIGITAL</b></a>
    </div>
    <div class="card-header text-center">
    </div>
    <div class="card-body">
    <div class="card-header text-center">
    </div>
      <p class="login-box-msg">Aplikasi untuk menampilkan rute perjalanan dan energi yang digunakan</p>

      

      <div class="social-auth-links text-center mt-2 mb-3">
        
      </div>
      <!-- /.social-auth-links -->
    </div>
    <!-- /.card-body -->
  </div>

</div>
<div class="modal-body py-0">
        <p>Kebutuhan transportasi pengguna kendaraan sangat beragam. Data mengenai jarak tempuh dan waktu tempuh dapat diperoleh melalui peta digital. Beberapa aplikasi peta digital telah menyediakan API (Application Programming Interface) untuk mempermudah memperoleh data tersebut. Namun, data yang diperoleh masih belum memuat informasi mengenai berapa besaran energi yang diperlukan untuk menempuh perjalanan tersebut. Hal tersebut wajar karena untuk mengetahui besaran energi, dibutuhkan informasi mengenai beban atau muatan operasi kendaraan. </p>
        <p>Aplikasi berbasis web ini merupakan integrasi API peta digital. Peta digital menggunakan library dari <a href="https://maptalks.org">Maptalks</a>, sedangkan API menggunakan servis dari <a href="https://www.geoapify.com/">Geoapify</a>. Untuk menentukan penggunaan energi, beberapa asumsi beban atau muatan operasi kendaraan digunakan.</p>
</div>
</div>
<!-- /.modal-content -->
</div>
<!-- /.modal-dialog -->
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<script src="used.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/maptalks/dist/maptalks.min.js"></script>

    <script type="text/javascript">
var globarr = [],initlat = -0.031090099094313928,initlong = 109.3442369665205,initzoom = 12.8,apii='2dbf6708e9484c559e44dfdde6978423';
thetade= new Date(),
vyear = thetade.getFullYear(),vmonth=thetade.getMonth() + 1,vdate=thetade.getDate(),
mapshow = new maptalks.Map('mapshow', {
center: [initlong,initlat],
zoom: initzoom
}).on('click', function(a){
mapShowOnClick(a);
})
layertitikarahshow = new maptalks.VectorLayer('layertitikarahshow').addTo(mapshow),
layerMarkerShow = new maptalks.VectorLayer('layermarkershow').addTo(mapshow),
layerMarkerClick = new maptalks.VectorLayer('layermarkerclick').addTo(mapshow),
layerKetDistance = new maptalks.VectorLayer('layerKetDistance').addTo(mapshow),
mapShowClickMarker = new maptalks.Marker().addTo(mapshow.getLayer('layermarkerclick'));
mapshow.sortLayers(['layerKetDistance', 'layermarkerclick', 'layermarkershow', 'layertitikarahshow']);


globarr['osm'] = new maptalks.TileLayer('osm', {
urlTemplate: 'https://tile.openstreetmap.org/{z}/{x}/{y}.png',maxZoom: 19,
attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
});
globarr['satelite'] = new maptalks.TileLayer('satelite', {
urlTemplate: 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',maxZoom: 19,
attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
});
cTileLayerShow('osm');
function cTileLayerShow(b){
if(!$.isEmptyObject(globarr[b])){
mapshow.setBaseLayer(globarr[b]);
}
}
/*var requestOptions = {
method: 'GET',
};

fetch("https://api.geoapify.com/v1/routing?waypoints=50.96209827745463%2C4.414458883409225%7C50.429137079078345%2C5.00088081232559&mode=drive&apiKey=2dbf6708e9484c559e44dfdde6978423", requestOptions)
.then(response => response.json())
.then(result => console.log(result))
.catch(error => console.log('error', error));

https://api.geoapify.com/v2/place-details?lat=-0.025489697584205828&lon=109.33909390600826&apiKey=YOUR_API_KEY


*/


window.addEventListener('DOMContentLoaded', event => {
  if(checkCompat()){
  let b=locStorr(),c=sesStorr();
  try {

  clearRuteExist();
  //geetjsonrute();

  }
  catch(err) {
  $('body').html('Terjadi Kesalahan');
  }
  }else{
  $('body').html('Browser anda tidak mendukung aplikasi');
  }

});
function toCenterLoc(){
  urlLoader('GET','https://api.geoapify.com/v1/ipinfo?&apiKey='+apii,'json','').
  then(function(t){
    //console.log(t.location.latitude) // latitude longitude
    if (typeof(t.location) !== "undefined") {
      mapshow.setCenter([parseFloat(t.location.longitude),parseFloat(t.location.latitude)]);
    }
  })
}
function clearRuteExist(){
  let b=locStorr(),c=sesStorr();
  let r=[{"lat":'',"long":'','nm':'-<br />-'},{"lat":'',"long":'','nm':'-<br />-'}],s = JSON.stringify({'rute':r,'avoid':'','mass':200,'roll':0.01,'g':9.81,'densitiy':1.23,'coefair':0.88,'adjustfront':0.70,'widthfront':0.78,'heightfront':1.63});
    localStorage.setItem('listrute',s);
  genListRuteField();
}

function genListRuteField(){
  let b=locStorr(),c=sesStorr();
  let ee=JSON.parse(b.listrute);
  //console.log(ee);
  let numbered=0;
  mapshow.getLayer('layertitikarahshow').clear();
  $('#jmltitik').html(ee.rute.length);
  $('#filterdialog').html('');
    for (let i = ee.rute.length - 1; i >= 0; i--) {
      genTitikArah(i,ee.rute);
    }
}
function genTitikArah(i,ee){
  numbered=i+1;
  globarr['marker'+i] = new maptalks.Marker().addTo(mapshow.getLayer('layertitikarahshow'));
  globarr['marker'+i].updateSymbol({
  'markerFile' : 'imerah.png',
  'markerWidth' : 45,
  'markerHeight' : 45,
  'markerDy':10
  })
  globarr['marker'+i].setCoordinates([ee[i].long,ee[i].lat]);
  globarr['marker'+i].show();
  //console.log('x loc'+a.coordinate.x)
  let aa=$('<li />').attr({'class':'list-group-item d-flex justify-content-between lh-sm'}),
  aaa=$('<div />'),
  ab=$('<span />').attr({'class':'btn btn-outline-secondary'}).html('<i class="bi bi-pin-angle-fill"></i><br />'+numbered),
  ac=$('<h6 />').attr({'class':'my-0','id':'lokasitext'+i}).html(ee[i].nm),
  ad=$('<small />').attr({'class':'text-body-secondary'}).html(' '),
  aee=$('<div />').attr({'class':'input-group input-group-sm mb-3'}),
  //ae=$('<span />').attr({'class':'btn btn-primary btn-sm'}).html('<i class="bi bi-arrow-up-circle"></i> Naik'),
  //af=$('<span />').attr({'class':'btn btn-primary btn-sm'}).html('<i class="bi bi-arrow-down-circle"></i> Turun'),
  ag=$('<span />').attr({'class':'btn btn-danger btn-sm'}).html('<i class="bi bi-dash-circle-fill"></i> Hapus').on('click',function(){hapusFieldRute(i)}),
  ah=$('<span />').attr({'class':'btn btn-success btn-sm'}).html('<i class="bi bi-eraser-fill"></i> Clear').on('click',function(){clearFieldRute(i)});
  ad.append([ag,ah]);
  aaa.append([ac,ad]);
  aa.append([aaa,ab]);

  $('#filterdialog').prepend(aa);
}
function tambahTitikArah(){
  let b=locStorr(),c=sesStorr();
  let ee=JSON.parse(b.listrute);
  let r={"lat":'',"long":'','nm':'<br />'};
  ee.rute.push(r);
  let myPromise = new Promise(function(myResolve, myReject) {
    let s = JSON.stringify(ee);
    localStorage.setItem('listrute',s);
    myResolve(); // when successful
    myReject();  // when error
  });
  myPromise.then(
    function() {genListRuteField();},
    function() {console.log('error')}
  );
  
}
function hapusFieldRute(a){
  let b=locStorr(),c=sesStorr();
  let ee=JSON.parse(b.listrute);
  let thearr = [];
  let myPromise = new Promise(function(myResolve, myReject) {
    for (let i = 0; i <= ee.rute.length - 1; i++) {
      //console.log(ee.rute[i].lat,ee.rute[i].long);
      if(i!=a){
        thearr.push(ee.rute[i]);
      }
    }
    myResolve(); // when successful
    myReject();  // when error
  });
  myPromise.then(
    function() {
      ee.rute=thearr;
      let s = JSON.stringify(ee);
      localStorage.setItem('listrute',s);
    },
    function() {console.log('error')}
  ).then(
    function(){
      genListRuteField();
    }
  );
}
function clearFieldRute(a){
  let b=locStorr(),c=sesStorr();
  let ee=JSON.parse(b.listrute);
  $('#lokasitext'+a).html('-<br />-');

  ee.rute[a].lat='';
  ee.rute[a].long='';
  ee.rute[a].nm='-<br />-';
  let ns = JSON.stringify(ee);
  localStorage.setItem('listrute',ns);
  globarr['marker'+a].hide();
}
function mapShowOnClick(a){
  let b=locStorr(),c=sesStorr();
  let ee=JSON.parse(b.listrute);

  for (let i = 0; i <= ee.rute.length - 1; i++) {
    //console.log(ee.rute[i].lat,ee.rute[i].long);
    if(ee.rute[i].lat==''||ee.rute[i].long==''){
      mapshow.identify(
      {
      'coordinate' : a.coordinate,
      'layers' : ['layermarkershow']
      },
      function (geos) {
        if (geos.length === 0) {
          doMapShowClick(a,i);
        }
      }
      );
      break;
    }
  }
  //console.log(a.coordinate);
}
function doMapShowClick(a,i){
  let b=locStorr(),c=sesStorr();
  let ee=JSON.parse(b.listrute);
  globarr['marker'+i].updateSymbol({
  'markerFile' : 'imerah.png',
  'markerWidth' : 45,
  'markerHeight' : 45,
  'markerDy':10
  })
  globarr['marker'+i].setCoordinates([a.coordinate.x,a.coordinate.y]);
  globarr['marker'+i].show();
  //console.log('x loc'+a.coordinate.x)

  //$('#titik'+i).attr({'value':a.coordinate.x+','+a.coordinate.y});
  urlLoader('GET','https://api.geoapify.com/v1/geocode/reverse?lat='+a.coordinate.y+'&lon='+a.coordinate.x+'&apiKey='+apii,'json','').
  then(function(t){
    //console.log(t.features[0].properties.datasource.formatted)
    //console.log(t.features[0].properties.formatted)
    $('#lokasitext'+i).html(t.features[0].properties.formatted);
      ee.rute[i].lat=a.coordinate.y;
      ee.rute[i].long=a.coordinate.x;
      ee.rute[i].nm=t.features[0].properties.formatted;
      let ns = JSON.stringify(ee);
      localStorage.setItem('listrute',ns);
  })
}
function geetjsonrute(){
  let b=locStorr(),c=sesStorr();
  let ee=JSON.parse(b.listrute);
  let txtarr = [];
  mapshow.getLayer('layerKetDistance').clear();
  if(ee.rute.length>1){
    for (let i = 0; i <= ee.rute.length - 1; i++) {
      if(ee.rute[i].lat==''||ee.rute[i].long==''){
      }else{
        txtarr.push(ee.rute[i].lat+','+ee.rute[i].long);
      }
    }
    if(txtarr.length>1){
      let txt = txtarr.join("|");
      //console.log(txt);
      //urlLoader('GET','https://api.geoapify.com/v1/routing?waypoints=50.96209827745463%2C4.414458883409225%7C50.429137079078345%2C5.00088081232559&mode=motorcycle&apiKey=2dbf6708e9484c559e44dfdde6978423','json','').
      urlLoader('GET','https://api.geoapify.com/v1/routing?waypoints='+txt+'&mode=motorcycle&avoid=location:-0.053325,109.323976|location:-0.039613,109.308422|location:-0.050255,109.351502|location:-0.035111,109.333595&apiKey='+apii,'json','').
      then(function(t){
        if (typeof(t.features) !== "undefined") {
          doGenerateRoute(t.features[0]);
        }else{
          alert('Rute Tidak Ditemukan');
        }
        
        /*console.log(t);

      https://api.geoapify.com/v1/routing?waypoints=-0.032245459875781535,109.30750151414202|-0.048003849310831015,109.3103666765686|-0.057110968898911096,109.33564150226573|-0.0398176733593516,109.3613256368809&mode=drive&avoid=location:-0.053325,109.323976|location:-0.039613,109.308422|location:-0.050255,109.351502|location:-0.035111,109.333595&apiKey=YOUR_API_KEY


      console.log(t.statusCode);
      console.log(t.features);
      console.log(t.properties);*/
      })
      .then(function(){
      });
    }
  }
}
function doGenerateRoute(t){
  $('#detaildialog').html('');
  //console.log(t.properties.legs);
  let b=locStorr(),c=sesStorr();
  let ee=JSON.parse(b.listrute); //JSON.stringify({'rute':r,'avoid':'','mass':200,'roll':0.01,'g':9.81,'densitiy':1.23,'coefair':0.88,'adjustfront':0.70,'widthfront':0.78,'heightfront':1.63});
  let frontarea = ee.widthfront*ee.heightfront;
  let adjustfront = frontarea*ee.adjustfront;
  let froll = ee.roll*ee.mass*ee.g;
  let totwh = 0;
  for (let i = 0; i <= t.geometry.coordinates.length - 1; i++) {
    //console.log(t.geometry.coordinates[i]);
    globarr['route'+i] = new maptalks.MultiLineString().addTo(mapshow.getLayer('layerKetDistance'));
    globarr['route'+i].updateSymbol({
      'lineColor' : '#c7d8ff',
      'lineWidth' : 8,
    });
    globarr['route'+i].setCoordinates(
      [
        t.geometry.coordinates[i]
      ]
    );
  }
  for (let i = 0; i <= t.properties.legs.length - 1; i++) {
    //console.log(t.properties.legs[i].distance);
    //console.log(t.properties.legs[i].time);
    //console.log(t.properties.legs[i]);
    //console.log(t.properties.legs[i].steps);
    //console.log(t.properties.legs[i].distance);
    //console.log(t.properties.legs[i].time);
    for (let j = 0; j <= t.properties.legs[i].steps.length - 1; j++) {
      //console.log(t.properties.legs[i].steps[j]);
      globarr['leg'+i+''+j] = new maptalks.MultiLineString().addTo(mapshow.getLayer('layerKetDistance'));
      globarr['leg'+i+''+j].updateSymbol({
        'lineColor' : '#507de6',
        'lineWidth' : 4,
        'lineJoin' : 'miter',
        'lineCap':'round',
        'lineDasharray' : [7,10],
      });
      let thearr = [];
      for (let k = t.properties.legs[i].steps[j].from_index; k <= t.properties.legs[i].steps[j].to_index; k++) {
        //console.log(t.geometry.coordinates[i][k]);
        thearr.push(t.geometry.coordinates[i][k]);
      }
      //console.log(thearr);
      //console.log(t.properties.legs[i].steps[j]);
      globarr['leg'+i+''+j].setCoordinates(
        [
          thearr
        ]
      );

      if(parseFloat(t.properties.legs[i].steps[j].time)!=0){
        let legdistance = parseFloat(t.properties.legs[i].steps[j].distance);
        let legtime = parseFloat(t.properties.legs[i].steps[j].time);
        let legspeed = legdistance/legtime;
        let legspeedtxt = legspeed*3.6;
        let legspeedsquare = legspeed*legspeed;


        let proll = froll*legspeed;

        let powair = 0.5*ee.densitiy*legspeedsquare*ee.coefair*adjustfront;
        let airresist = powair*legspeed;
        let totpower = Number(airresist.toFixed(2))+Number(proll.toFixed(2));
        let totpowertext = totpower/1000;
        let wattperleg = Number(totpower.toFixed(2))*legtime;
        let perhour = wattperleg/3600;
        let perhourtext = perhour/1000;
        totwh += perhour;


        let de=$('<ul />').attr({'class':'list-group mb-3'}),
        dc=$('<li />').attr({'class':'list-group-item d-flex text-light bg-dark justify-content-between'}).html('<span><i class="fa fa-map-pin mr-1"></i>'+t.properties.legs[i].steps[j].instruction.text+'</span>'),
        df=$('<li />').attr({'class':'list-group-item d-flex justify-content-between'}).html('<span>Jarak </span><strong>'+legdistance+' meter</strong>'),

        dg=$('<li />').attr({'class':'list-group-item d-flex justify-content-between'}).html('<span>Prakiraan Kecepatan Rata-rata</span><strong>'+Number(legspeedtxt.toFixed(2))+" km/H</strong>"),

        dh=$('<li />').attr({'class':'list-group-item d-flex justify-content-between'}).html("<span>Prakiraan Kebutuhan Daya </span><strong>"+Number(totpowertext.toFixed(2))+" Kw</strong>"),

        di=$('<li />').attr({'class':'list-group-item d-flex justify-content-between'}).html("<span>Prakiraan Energi Digunakan</span><strong>"+Number(perhourtext.toFixed(5))+" KwH</strong>");

        /*let da=$('<div />').attr({'class':'card','style':'width:100%;'}),
        db=$('<div />').attr({'class':'card-header'}),
        dc=$('<h3 />').attr({'class':'card-title'}).html('<i class="fa fa-map-pin mr-1"></i>'+t.properties.legs[i].steps[j].instruction.text),
        dd=$('<div />').attr({'class':'card-body'});
        $('#detaildialog').append(da);*/
        de.append([dc,df,dg,dh,di]);
          $('#detaildialog').append(de);
          /*console.log(legspeed);
          console.log(proll.toFixed(2));
          console.log(airresist.toFixed(2));
          console.log(totpower);
          console.log(perhour);*/

          /*
          <li class="list-group-item d-flex justify-content-between">
              <span>Total (USD)</span>
              <strong>$20</strong>
            </li>*/


        //db.append(dc);
        //da.append([db,dd]);
        globarr['leg'+i+''+j].setInfoWindow({
          'title'     : t.properties.legs[i].steps[j].instruction.text,
          'content'   : de.html()
        });
        globarr['leg'+i+''+j].on('mouseout', function () {
          globarr['leg'+i+''+j].closeInfoWindow();
          globarr['leg'+i+''+j].updateSymbol({
            'lineColor' : '#507de6',
            'lineWidth' : 4,
            'lineJoin' : 'miter',
            'lineCap':'round',
            'lineDasharray' : [7,10],
          });
        }).on('mouseenter', function () {
          globarr['leg'+i+''+j].openInfoWindow();
          globarr['leg'+i+''+j].updateSymbol({
            'lineColor' : '#eb4034',
            'lineWidth' : 4,
            'lineDasharray' : [0,0],
          });
        });
        de.on('mouseenter',function(){
          globarr['leg'+i+''+j].openInfoWindow();
          globarr['leg'+i+''+j].updateSymbol({
            'lineColor' : '#eb4034',
            'lineWidth' : 4,
            'lineDasharray' : [0,0],
          });
        });
        de.on('mouseleave',function(){
          globarr['leg'+i+''+j].closeInfoWindow();
          globarr['leg'+i+''+j].updateSymbol({
            'lineColor' : '#507de6',
            'lineWidth' : 4,
            'lineJoin' : 'miter',
            'lineCap':'round',
            'lineDasharray' : [7,10],
          });
        });
      }
    }

    /*globarr['leg'+i] = new maptalks.MultiLineString().addTo(mapshow.getLayer('layerKetDistance'));
    globarr['leg'+i].updateSymbol({
      'lineColor' : '#2129ff',
      'lineWidth' : 3,
    });*/
    /*globarr['leg'+i].setCoordinates(
      [
        t.geometry.coordinates[i]
      ]
    );
    speed = distance/time
    distance = speed x time
    speed = distance/time*/
  }
  let totwhtext = totwh/1000;
  let timmtext = t.properties.time/60;
  let ea=$('<ul />').attr({'class':'list-group mb-3'}),
  eb=$('<li />').attr({'class':'list-group-item d-flex text-light bg-primary justify-content-between'}).html('<span><i class="fa fa-map-pin mr-1"></i> Prakiraan Total Energi</span>'),
  ec=$('<li />').attr({'class':'list-group-item d-flex justify-content-between'}).html("Total Jarak Tempuh : "+t.properties.distance+" meter"),
  ed=$('<li />').attr({'class':'list-group-item d-flex justify-content-between'}).html("Total Prakiraan Waktu Tempuh : "+Number(timmtext.toFixed(0))+" menit"),
  eee=$('<li />').attr({'class':'list-group-item d-flex justify-content-between'}).html("Total Prakiraan Penggunaan Energi : "+Number(totwhtext.toFixed(5))+" KwH");
  ea.append([eb,ec,ed,eee]);
  $('#detaildialog').prepend(ea);


  //console.log(totwhtext);console.log(t);
}
    </script>
    </body>
</html>
